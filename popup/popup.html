<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Text Proofreader</title>
    <link rel="stylesheet" href="popup.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>üîç AI Text Proofreader</h1>
        </header>

        <div class="tabs">
            <button class="tab-button active" data-tab="proofread">Proofread</button>
            <button class="tab-button" data-tab="settings">Settings</button>
        </div>

        <!-- Proofread Tab -->
        <div id="proofread-tab" class="tab-content active">
            <div class="section">
                <label for="input-text">Enter text to proofread:</label>
                <textarea id="input-text" placeholder="Paste or type your text here..." rows="6"></textarea>
            </div>

            <div class="button-group">
                <button id="proofread-btn" class="primary-btn">üîç Proofread Text</button>
                <button id="suggestions-btn" class="secondary-btn">üí° Get Suggestions</button>
            </div>

            <div id="loading" class="loading hidden">
                <div class="spinner"></div>
                <span>Processing with AI...</span>
            </div>

            <div id="result-section" class="section hidden">
                <label>Result:</label>
                <textarea id="output-text" rows="6" readonly></textarea>
                <div class="button-group">
                    <button id="copy-result" class="secondary-btn">üìã Copy Result</button>
                    <button id="accept-changes" class="primary-btn">‚úÖ Accept Changes</button>
                </div>
            </div>

            <div id="suggestions-section" class="section hidden">
                <label>Suggestions:</label>
                <div id="suggestions-list" class="suggestions-container"></div>
            </div>
        </div>

        <!-- Settings Tab -->
        <div id="settings-tab" class="tab-content">
            <div class="section">
                <label for="provider-select">LLM Provider:</label>
                <select id="provider-select">
                    <option value="local">Local LLM (Ollama)</option>
                    <option value="openai">OpenAI</option>
                    <option value="custom">Custom Endpoint</option>
                </select>
            </div>

            <div class="section">
                <label for="model-input">Model Name:</label>
                <input type="text" id="model-input" placeholder="e.g., llama2, gpt-3.5-turbo">
                <small>For local: ollama model name. For OpenAI: model ID</small>
            </div>

            <div id="openai-settings" class="section hidden">
                <label for="api-key-input">OpenAI API Key:</label>
                <input type="password" id="api-key-input" placeholder="sk-...">
                <small>Your API key is stored locally and never shared</small>
            </div>

            <div id="custom-settings" class="section hidden">
                <label for="custom-endpoint-input">Custom Endpoint URL:</label>
                <input type="url" id="custom-endpoint-input" placeholder="https://your-llm-api.com/generate">
                <small>Custom LLM API endpoint</small>
            </div>

            <div class="section">
                <h3>Local LLM Setup (Ollama)</h3>
                <p>To use local LLMs:</p>
                <ol>
                    <li>Install <a href="https://ollama.ai" target="_blank">Ollama</a></li>
                    <li>Run: <code>ollama pull llama2</code></li>
                    <li>Set CORS: <code>$env:OLLAMA_ORIGINS="*"</code> (Windows)</li>
                    <li>Start: <code>ollama serve</code></li>
                </ol>
                <p><strong>Note:</strong> The CORS environment variable is required for browser extensions.</p>
                <button id="test-connection" class="secondary-btn">üîó Test Connection</button>
            </div>

            <div class="button-group">
                <button id="save-settings" class="primary-btn">üíæ Save Settings</button>
                <button id="reset-settings" class="secondary-btn">üîÑ Reset</button>
            </div>

            <div class="section">
                <h3>Debug Tools</h3>
                <button id="show-debug" class="secondary-btn">üêõ Show Debug Info</button>
                <div id="debug-info" class="debug-container hidden">
                    <textarea id="debug-output" rows="6" readonly placeholder="Debug information will appear here..."></textarea>
                    <button id="copy-debug" class="secondary-btn">üìã Copy Debug Info</button>
                </div>
            </div>

            <div id="connection-status" class="status hidden"></div>
        </div>

        <footer>
            <p>Select text on any webpage and right-click for AI proofreading</p>
        </footer>
    </div>

    <script src="popup.js"></script>
</body>
</html>
